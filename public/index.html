<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AI Mockup Generator</title>
  <style>
    body { margin: 0; font-family: Inter, sans-serif; background: #111; color: #fff; padding: 2rem; }
    .container { max-width: 1000px; margin: 0 auto; background: #111; padding: 2rem; border-radius: 16px; }
    h2 { text-align: center; font-size: 2rem; margin-bottom: 0.5rem; }
    .grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin: 1rem 0; }
    input, select, button { padding: 0.75rem; border-radius: 8px; width: 100%; }
    button { background: linear-gradient(90deg, #7c3aed, #3b82f6); color: white; border: none; font-weight: 600; cursor: pointer; }
    .mockup { background: #1a1a1a; padding: 1rem; border-radius: 12px; text-align: center; margin-top: 1rem; }
    .mockup img { width: 100%; height: 180px; object-fit: cover; border-radius: 8px; }
  </style>
</head>
<body>
  <div class="container" id="app"></div>

  <script type="module">
    import React, { useState } from "https://cdn.skypack.dev/react";
    import { createRoot } from "https://cdn.skypack.dev/react-dom/client";
    import { motion } from "https://cdn.skypack.dev/framer-motion";

    const API_URL = "/api/generate-mockups";

    const App = () => {
      const [file, setFile] = useState(null);
      const [product, setProduct] = useState("ornament");
      const [count, setCount] = useState(5);
      const [loading, setLoading] = useState(false);
      const [mockups, setMockups] = useState([]);
      const [error, setError] = useState("");

      const generate = async () => {
        if (!file) return setError("Upload design");
        setLoading(true); setError(""); setMockups([]);
        const form = new FormData();
        form.append("design", file);
        form.append("product", product);
        form.append("count", count);
        const res = await fetch(API_URL, { method: "POST", body: form });
        const data = await res.json();
        setLoading(false);
        if (!res.ok) return setError(data.error);
        setMockups(data.mockups);
      };

      return (
        <>
          <h2>AI Mockup Generator</h2>
          <div class="grid">
            <input type="file" accept="image/*" onChange={e => setFile(e.target.files[0])} />
            <select value={product} onChange={e => setProduct(e.target.value)}>
              <option>ornament</option><option>t-shirt</option><option>mug</option>
            </select>
            <input type="number" min="1" max="10" value={count} onChange={e => setCount(+e.target.value)} />
          </div>
          <button onClick={generate} disabled={loading}>
            {loading ? "Generating..." : `Generate ${count}`}
          </button>
          {error && <p style={{color:"red",textAlign:"center"}}>{error}</p>}
          <div style={{display:"grid", gridTemplateColumns:"repeat(auto-fill,minmax(200px,1fr))", gap:"1rem", marginTop:"2rem"}}>
            {mockups.map((m,i) => (
              <motion.div key={i} whileHover={{scale:1.05}} class="mockup">
                <img src={m.url} />
                <p>{m.prompt}</p>
                <a href={m.url} download style={{color:"#10b981",display:"block",marginTop:"0.5rem"}}>Download</a>
              </motion.div>
            ))}
          </div>
        </>
      );
    };

    createRoot(document.getElementById("app")).render(<App />);
  </script>
</body>
</html>
